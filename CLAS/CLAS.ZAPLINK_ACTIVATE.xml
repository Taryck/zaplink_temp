<?xml version="1.0" encoding="utf-16"?>
<ZL_OBJECT CHECKSUM="00B5A27725E65A895214732A94D8DB3A" CODE_SIGNATURE="11101FE6EB00C0ECB8C1AC8E12F72565" CONNECTOR="39AC0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_ACTIVATE" TYPE="CLAS" VERSION="1.01">
 <DIRECTORY DEVCLASS="ZAPLINK-FRAMEWORK-CORE" MASTERLANG="E"/>
 <RAW>
  <A0_MAINDATA VERSION="1" LANGU="E" EXPOSURE="2" STATE="1" CLSCCINCL="X" FIXPT="X" UNICODE="X" RSTAT="K">
   <TEXTS>
    <ITEM LANG="E" TEXT="ZAPLink : Activate components">U1&amp;FUNCTIONALITY&amp;
ASAllow to activate (compile) a component list.
U1&amp;RELATIONS&amp;
AS
U1&amp;EXAMPLE&amp;
AS
U1&amp;HINTS&amp;
AS
U1&amp;FURTHER_SOURCES_OF_INF&amp;
AS
U1Memories
ASThis application is dedicated to the memories of :
B2My father : Lamri BENSIALI (1940-2004) without whom I never started
  programming
B2My uncle : Jacky BEDU (1934-2009) who died during the completion of this
  application</ITEM>
   </TEXTS>
  </A0_MAINDATA>
  <ALIASES>
   <ITEM CMPNAME="TD_CHECKBOX" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_CHECKBOX"/>
   <ITEM CMPNAME="TD_COMPNAME" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_COMPNAME"/>
   <ITEM CMPNAME="TR_AUTHOR" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TR_AUTHOR"/>
   <ITEM CMPNAME="TR_COMPNAME" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TR_COMPNAME"/>
   <ITEM CMPNAME="TR_COMPTYPE" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TR_COMPTYPE"/>
   <ITEM CMPNAME="TR_PACKAGES" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TR_PACKAGES"/>
   <ITEM CMPNAME="TR_SRCSYSTEM" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TR_SRCSYSTEM"/>
   <ITEM CMPNAME="TT_COMPKEYS" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_COMPKEYS"/>
  </ALIASES>
  <ATTRIBUTS>
   <ITEM CMPNAME="ACTIVATION_REQUESTED" EXPOSURE="2" STATE="1" ATTRDONLY="X" TYPTYPE="1" TYPE="TD_CHECKBOX">
    <TEXTS>
     <ITEM LANG="E" TEXT="Do activation has been requested by user"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="COMPONENT_LIST" EXPOSURE="1" STATE="1" TYPTYPE="1" TYPE="TT_COMPKEYS">
    <TEXTS>
     <ITEM LANG="E" TEXT="Component list"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="FORCE_ACTIVATION" EXPOSURE="2" STATE="1" ATTRDONLY="X" TYPTYPE="1" TYPE="TD_CHECKBOX">
    <TEXTS>
     <ITEM LANG="E" TEXT="Force activation if error found"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="IT_ITEMS" EXPOSURE="1" STATE="1" TYPTYPE="1" TYPE="TT_ITEMS"/>
   <ITEM CMPNAME="IT_OBJ_LIST" EXPOSURE="1" STATE="1" TYPTYPE="1" TYPE="TT_OBJLIST">
    <TEXTS>
     <ITEM LANG="E" TEXT="Objects list"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="OBJECT_COUNT" EXPOSURE="2" STATE="1" ATTRDONLY="X" TYPTYPE="1" TYPE="I">
    <TEXTS>
     <ITEM LANG="E" TEXT="Object count in the list"/>
    </TEXTS>
   </ITEM>
  </ATTRIBUTS>
  <INTERFACES>
   <ITEM REFCLSNAME="ZAPLINK_DATATYPES" EXPOSURE="2" STATE="1" RELTYPE="1"/>
  </INTERFACES>
  <LOCAL>
   <TYPES>`
*&quot;* USE THIS SOURCE FILE FOR ANY TYPE DECLARATIONS (CLASS
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* IMPLEMENTATION OR PRIVATE METHOD&apos;S SIGNATURE</TYPES>
   <IMPLEMENTATIONS>`
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* use this source file for the implementation part of
*&quot;* LOCAL HELPER CLASSES</IMPLEMENTATIONS>
   <MACROS>`
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS</MACROS>
  </LOCAL>
  <METHODS>
   <ITEM CMPNAME="ACTIVATE" EXPOSURE="2" STATE="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Activate objects"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="FORCE_ACTIVATION" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CHECKBOX" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANG="E" TEXT="Activate Anyway"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TT_COMPKEYS">
      <TEXTS>
       <ITEM LANG="E" TEXT="Objects list not activate"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA:
    lb_actdone TYPE xflag,
    lc_before  TYPE i,
    lc_after   TYPE i,
    it_items   TYPE tt_items,
    it_progs   TYPE tt_objlist,
    it_mainp   TYPE tt_mainprogs,
    _mp        LIKE LINE OF it_mainp,
    dummy_tab  TYPE tt_items,
    it_objlist TYPE tt_objlist,
    it_ddic    TYPE tt_objlist,
    it_det_obj TYPE tt_det_obj.
*  FIELD-SYMBOLS:
*    &lt;mainp&gt; LIKE LINE OF it_mainp,
*    &lt;item&gt;  LIKE LINE OF it_items,
*    &lt;obj&gt;   LIKE LINE OF it_obj_list.

  it_obj_list = compkeys_2_objlist( component_list ).
  SORT it_obj_list BY object obj_name.
  DELETE ADJACENT DUPLICATES FROM it_obj_list COMPARING object obj_name.

  CALL METHOD split_list
    EXPORTING
      obj_list  = it_obj_list
    IMPORTING
      ddic      = it_ddic
      prog_list = it_progs.

* Try mass activation first (usefull for non DDIC objects)
  activate_ddic( CHANGING it_list = it_ddic ).
  activate_nonddic( CHANGING it_list = it_progs ).
  COMMIT WORK AND WAIT.

* do the loop
  DO.
    CLEAR lb_actdone.

*Active DDIC
    IF NOT it_ddic IS INITIAL.
      lc_before = LINES( it_ddic ).
      activate_ddic( CHANGING it_list = it_ddic ).
      lc_after = LINES( it_ddic ).
      IF lc_after &lt; lc_before.
        lb_actdone = abap_true.
        COMMIT WORK AND WAIT.
      ENDIF.
    ENDIF.

*Active NON DDIC
    IF NOT it_progs IS INITIAL.
      lc_before = LINES( it_progs ).
      activate_nonddic( EXPORTING one_by_one = &apos;X&apos;
                         CHANGING    it_list = it_progs ).
      lc_after = LINES( it_progs ).
      IF lc_after &gt;= lc_before.
        activate_nonddic( CHANGING    it_list = it_progs ).    &quot; Try mass activation
        lc_after = LINES( it_progs ).
      ENDIF.
      IF lc_after &lt; lc_before.
        lb_actdone = abap_true.
        COMMIT WORK AND WAIT.
      ENDIF.
    ENDIF.

    IF lb_actdone IS INITIAL. EXIT. ENDIF.
  ENDDO.

  IF force_activation IS NOT INITIAL.
    activate_nonddic( EXPORTING force_activation = force_activation
                                CHANGING it_list = it_progs ).
  ENDIF.

  APPEND LINES OF it_ddic TO it_objlist.
  APPEND LINES OF it_progs TO it_objlist.
  result = objlist_2_compkeys( it_objlist ).
** Switch into activation and generation
*  CALL FUNCTION &apos;RS_WORKING_OBJECTS_ACTIVATE&apos;
*    EXPORTING
**     SUPPRESS_SYNTAX_CHECK        =
*      suppress_generation          = &apos;X&apos;
**     P_WB_MANAGER                 =
**     SUPPRESS_INSERT              =
*     activate_ddic_objects        = &apos;X&apos;
**     WITH_POPUP                   = &apos; &apos;
*    TABLES
*      OBJECTS                      = it_det_obj
*    EXCEPTIONS
*      excecution_error             = 1
*      cancelled                    = 2
*      insert_into_corr_error       = 3
*      OTHERS                       = 4
*            .
*  IF sy-subrc &lt;&gt; 0.
**    MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
**            WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
*  ENDIF.
*
*  it_det_obj = get_inactive_objects( it_progs ).
*
*  CALL FUNCTION &apos;RS_WORKING_OBJECTS_ACTIVATE&apos;
*    EXPORTING
**     SUPPRESS_SYNTAX_CHECK        =
*      suppress_generation          = &apos;X&apos;
**     P_WB_MANAGER                 =
*      SUPPRESS_INSERT              = &apos;X&apos;
**     ACTIVATE_DDIC_OBJECTS        = &apos; &apos;
**     WITH_POPUP                   = &apos; &apos;
*    TABLES
*      OBJECTS                      = it_det_obj
*    EXCEPTIONS
*      excecution_error             = 1
*      cancelled                    = 2
*      insert_into_corr_error       = 3
*      OTHERS                       = 4
*            .
*  IF sy-subrc &lt;&gt; 0.
** MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
**         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
*  ENDIF.
*
*  it_items = conv_list( it_progs ).
*
** FROM LSEWORKINGAREAF01
**  PERFORM get_main_programs USING &apos;X&apos; with_popup .
*  DATA: l_progs TYPE rsnewleng-programm,
*        l_main TYPE STANDARD TABLE OF rsnewleng-programm WITH NON-UNIQUE DEFAULT KEY,
*        l_index TYPE i.
*  FIELD-SYMBOLS:
*    &lt;pname&gt; LIKE LINE OF l_main.
*
** Selektierte für ABAP setzen
*  CALL FUNCTION &apos;RS_WORKING_AREA_PREPARE&apos;
*    EXPORTING
*      suppress_init = &apos;X&apos;
*    EXCEPTIONS
*      OTHERS        = 1.
*
** FROM LSEWORKINGAREAF01 (366)
*  REFRESH it_mainp.
*  CLEAR it_mainp.
*  LOOP AT it_items ASSIGNING &lt;item&gt;.
*
*    CASE &lt;item&gt;-object.
*      WHEN &apos;CPRI&apos; OR &apos;CPRO&apos; OR &apos;CPUB&apos; OR &apos;CREP&apos; OR &apos;METH&apos; OR &apos;INTF&apos;
*           OR &apos;CINC&apos; OR &apos;CLAS&apos;.
**       Geht schneller die Klasse zu bestimmen
*        _mp-include = &lt;item&gt;-obj_name.
*        &lt;item&gt;-obj_name = &lt;item&gt;-obj_name(30).
*        TRANSLATE &lt;item&gt;-obj_name USING &apos;= &apos;.
*        _mp-master = &lt;item&gt;-obj_name.
*        _mp-object = &lt;item&gt;-object.
*        APPEND _mp TO it_mainp.
*        CONTINUE.
*      WHEN &apos;WAPD&apos; OR &apos;WAPA&apos;.
**       BSP-Applikation
*        _mp-include = &lt;item&gt;-obj_name.
*        _mp-master  = &lt;item&gt;-obj_name.
*        _mp-object  = &lt;item&gt;-object.
*        APPEND _mp TO it_mainp.
*        CONTINUE.
*      WHEN &apos;WAPP&apos;.
**       BSP-Seite
*        _mp-include = &lt;item&gt;-obj_name+30.
*        _mp-master  = &lt;item&gt;-obj_name(30).
*        _mp-object  = &lt;item&gt;-object.
*        APPEND _mp TO it_mainp.
*        CONTINUE.
*      WHEN &apos;WDYN&apos;.
**       Web Dynpro-Applikation
*        _mp-include = &lt;item&gt;-obj_name.
*        _mp-master  = &lt;item&gt;-obj_name.
*        _mp-object  = &lt;item&gt;-object.
*        APPEND _mp TO it_mainp.
*        CONTINUE.
*      WHEN &apos;WDYD&apos; OR &apos;WDYV&apos; OR &apos;WDYC&apos;.
**       Web Dynpro
*        _mp-include = &lt;item&gt;-obj_name+30.
*        _mp-master  = &lt;item&gt;-obj_name(30).
*        _mp-object  = &lt;item&gt;-object.
*        APPEND _mp TO it_mainp.
*        CONTINUE.
*
*      WHEN &apos;ENHO&apos; OR &apos;ENHC&apos; OR &apos;ENHS&apos; OR &apos;ENSC&apos;.
**       Enhancement Objects
*        _mp-include = &lt;item&gt;-obj_name.
*        _mp-master  = &lt;item&gt;-obj_name.
*        _mp-object  = &lt;item&gt;-object.
*        APPEND _mp TO it_mainp.
*        CONTINUE.
*
*      WHEN &apos;SFBF&apos; OR &apos;SFSW&apos; OR &apos;SFBS&apos; OR &apos;SF01&apos;.
**       Switch Framework
*        _mp-include = &lt;item&gt;-obj_name.
*        _mp-master  = &lt;item&gt;-obj_name.
*        _mp-object  = &lt;item&gt;-object.
*        APPEND _mp TO it_mainp.
*        CONTINUE.
*
*      WHEN &apos;WEBI&apos; OR &apos;WEBS&apos;.
**       Webservices
*        _mp-include = &lt;item&gt;-obj_name.
*        _mp-master  = &lt;item&gt;-obj_name.
*        _mp-object  = &lt;item&gt;-object.
*        APPEND _mp TO it_mainp.
*        CONTINUE.
*      WHEN &apos;SFPF&apos; OR &apos;SFPI&apos;.
**       Formulare
*        _mp-include = &lt;item&gt;-obj_name.
*        _mp-master  = &lt;item&gt;-obj_name.
*        _mp-object  = &lt;item&gt;-object.
*        APPEND _mp TO it_mainp.
*        CONTINUE.
*      WHEN OTHERS.
*        PERFORM convert_object_for_abap IN PROGRAM saplseworkingarea
*                                          TABLES dummy_tab
*                                        CHANGING &lt;item&gt;.
*    ENDCASE.
*    CHECK &lt;item&gt;-object = &apos;REPS&apos;.
*    CHECK &lt;item&gt;-obj_name(1) &lt;&gt; &apos;&lt;&apos; AND &lt;item&gt;-obj_name(1) &lt;&gt; &apos;&gt;&apos;.
*    l_progs = &lt;item&gt;-obj_name.
**   Type-Pools
*    IF &lt;item&gt;-obj_name(3) = &apos;%_C&apos;.
*      _mp-include = &lt;item&gt;-obj_name.
*      _mp-master = &lt;item&gt;-obj_name.
*      _mp-object = &lt;item&gt;-object.
*      APPEND _mp TO it_mainp.
*      CONTINUE.
*    ENDIF.
**   PG030801 wenn Rahmenprogramm zu REPS schon bekannt, kein Dialog
*    IF &lt;item&gt;-object = &apos;REPS&apos;
*    AND &lt;item&gt;-main_item_object = &apos;PROG&apos;
*    AND &lt;item&gt;-main_item NE space.
*      _mp-include = &lt;item&gt;-obj_name.
*      _mp-master = &lt;item&gt;-main_item.
*      _mp-object = &lt;item&gt;-object.
*      APPEND _mp TO it_mainp.
*    ELSE.
**     Rahmenprogramme per Dialog bestimmen
*      CALL FUNCTION &apos;RS_GET_MAINPROGRAMS&apos;
*         EXPORTING
*              fulltab      = &apos;X&apos;
**             dialog_required = &apos;X&apos;
*              dialog       = &apos; &apos; &quot;with_dialog  &quot;  &apos;X&apos;
*              name         = l_progs
*         IMPORTING
*              tindex       = l_index
**              number_of_mainprograms = l_number
*         TABLES
*              mainprograms = l_main
*         EXCEPTIONS
*              cancelled    = 1
*              OTHERS       = 2.
*      IF sy-subrc = 1.
**        g_cancel_flag = &apos;X&apos;.
**        work_items[] = l_items[].
**        working_area[] = l_work[].
**        EXIT.
*      ENDIF.
*      IF l_index &lt;&gt; 0.
*        READ TABLE l_main INDEX l_index ASSIGNING &lt;pname&gt;.
*        IF sy-subrc = 0.
*          _mp-include = &lt;item&gt;-obj_name.
*          _mp-master = &lt;pname&gt;.
*          _mp-object = &lt;item&gt;-object.
*          APPEND _mp TO it_mainp.
*        ENDIF.
*      ELSE.
*        LOOP AT l_main ASSIGNING &lt;pname&gt;.
*          _mp-include = &lt;item&gt;-obj_name.
*          _mp-master = &lt;pname&gt;.
*          _mp-object = &lt;item&gt;-object.
*          APPEND _mp TO it_mainp.
*        ENDLOOP.
*      ENDIF.
*    ENDIF.
*  ENDLOOP.
*
*  CALL METHOD activate_objects
*    EXPORTING
*      programs = it_mainp
*      items    = it_items.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ACTIVATE_DDIC" EXPOSURE="1" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Activate DDIC"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="IT_LIST" CMPTYPE="1" PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_OBJLIST">
      <TEXTS>
       <ITEM LANG="E" TEXT="Objects list"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA:
    it_debug TYPE STANDARD TABLE OF ddmsactrc WITH NON-UNIQUE DEFAULT KEY.
  FIELD-SYMBOLS:
    &lt;wa&gt; LIKE LINE OF it_debug.

*Active DDIC
  CALL FUNCTION &apos;SEO_BUFFER_REFRESH&apos;
   EXPORTING
*     CIFKEY        =
*     VERSION       = SEOC_VERSION_INACTIVE
      force         = &apos;X&apos;.
  CALL FUNCTION &apos;SEO_BUFFER_REFRESH&apos;
   EXPORTING
*     CIFKEY        =
      version       = 1
      force         = &apos;X&apos;.

*  CALL FUNCTION &apos;RS_DD_WORKLIST_ACTIVATE&apos; in UPDATE TASK
*    EXPORTING
*      p_generate_active_obj = &apos;X&apos;
*      i_suppress_dialog     = &apos;X&apos;
*    TABLES
*      t_worklist            = it_list
*      t_act_obj             = it_debug.
  CALL FUNCTION &apos;RS_DD_WORKLIST_ACTIVATE&apos;
    EXPORTING
      p_generate_active_obj = &apos;X&apos;
      i_suppress_dialog     = &apos;X&apos;
    TABLES
      t_worklist            = it_list
      t_act_obj             = it_debug
    EXCEPTIONS
      not_all_activated     = 1
      error_occured         = 2
      locked                = 3
      OTHERS                = 4.
  IF sy-subrc &lt;= 1.
    LOOP AT it_debug ASSIGNING &lt;wa&gt;.
      DELETE it_list
          WHERE pgmid = &lt;wa&gt;-pgmid
            AND object = &lt;wa&gt;-type
            AND obj_name = &lt;wa&gt;-name.
    ENDLOOP.
  ENDIF.
  COMMIT WORK AND WAIT.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ACTIVATE_DDIC_V2" EXPOSURE="1" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Activate DDIC V2"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="IT_LIST" CMPTYPE="1" PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_OBJLIST">
      <TEXTS>
       <ITEM LANG="E" TEXT="Objects list"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="ONE_BY_ONE" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="XFLAG" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANG="E" TEXT="Activate objects one by one"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA:
    _wb_manager TYPE REF TO  if_wb_manager,   &quot;#EC NEEDED
    it_obj TYPE tt_det_obj,
    it_det_obj TYPE tt_det_obj.
*  FIELD-SYMBOLS:
*    &lt;disable_popup&gt; TYPE data,        &quot; DATA: xcode LIKE rsnewleng-tcode,
*    &lt;obj&gt; LIKE LINE OF it_det_obj.

*Active NON DDIC
*  ASSIGN (&apos;(SAPLSEWORKINGAREA)xcode&apos;) TO &lt;disable_popup&gt;.
*  IF sy-subrc = 0.
*    &lt;disable_popup&gt; = &apos;CHEC&apos;. &quot; LSEWORKINGAREAFCK from CHECKLIST_EVALUATE line 2134
*  ENDIF.
*  it_det_obj = get_inactive_objects( it_list ).
*  count = LINES( it_det_obj ).
*  IF one_by_one IS INITIAL.
**    it_det_obj = conv_list( it_list ).
  it_det_obj = get_inactive_objects( it_list ).
  CALL FUNCTION &apos;RS_WORKING_OBJECTS_ACTIVATE&apos;
    EXPORTING
*     SUPPRESS_SYNTAX_CHECK        =
*     SUPPRESS_GENERATION          =
*     P_WB_MANAGER                 =
*     SUPPRESS_INSERT              =
      activate_ddic_objects        = &apos;X&apos;
*     WITH_POPUP                   = &apos; &apos;
*     CWB_MODE                     =
    TABLES
      OBJECTS                      = it_det_obj
    EXCEPTIONS
      excecution_error             = 1
      cancelled                    = 2
      insert_into_corr_error       = 3
      OTHERS                       = 4
            .
  IF sy-subrc &lt;&gt; 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

  CALL FUNCTION &apos;RS_MASS_ACTIVATION&apos;
    EXPORTING
      p_wb_manager = _wb_manager
    TABLES
      OBJECTS      = it_det_obj.
*  ELSE.
*    it_det_obj = conv_list( it_list ).
*    LOOP AT it_det_obj ASSIGNING &lt;obj&gt;.
*      CLEAR it_obj.
*      APPEND &lt;obj&gt; TO it_obj.
*      CALL FUNCTION &apos;RS_MASS_ACTIVATION&apos;
*        EXPORTING
*          p_wb_manager = _wb_manager
*        TABLES
*          OBJECTS      = it_obj.
*    ENDLOOP.
*  ENDIF.
  check_inactive_objects( CHANGING obj_list = it_list ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ACTIVATE_NONDDIC" EXPOSURE="1" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Activate NONDDIC"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="FORCE_ACTIVATION" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CHECKBOX" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANG="E" TEXT="Activate Anyway"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="IT_LIST" CMPTYPE="1" PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_OBJLIST">
      <TEXTS>
       <ITEM LANG="E" TEXT="Objects list"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="ONE_BY_ONE" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CHECKBOX" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANG="E" TEXT="Activate objects one by one"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA:
    _wb_manager TYPE REF TO  if_wb_manager,                 &quot;#EC NEEDED
    it_obj TYPE tt_det_obj,
    it_det_obj TYPE tt_det_obj.
  FIELD-SYMBOLS:
    &lt;disable_popup&gt; TYPE data,        &quot; DATA: xcode LIKE rsnewleng-tcode,
    &lt;obj&gt; LIKE LINE OF it_det_obj.

*Active NON DDIC
  ASSIGN (&apos;(SAPLSEWORKINGAREA)xcode&apos;) TO &lt;disable_popup&gt;.
  IF sy-subrc = 0.
    &lt;disable_popup&gt; = &apos;CHEC&apos;. &quot; LSEWORKINGAREAFCK from CHECKLIST_EVALUATE line 2134
  ENDIF.
*  it_det_obj = get_inactive_objects( it_list ).
*  count = LINES( it_det_obj ).
  IF one_by_one IS INITIAL.
    it_det_obj = conv_list( it_list ).
*    it_det_obj = get_inactive_objects( it_list ).
    CALL FUNCTION &apos;RS_MASS_ACTIVATION&apos;
      EXPORTING
        p_wb_manager = _wb_manager
      TABLES
        OBJECTS      = it_det_obj.
    IF force_activation IS NOT INITIAL.
      PERFORM activate_object IN PROGRAM saplseworkingarea.
    ENDIF.
  ELSE.
    it_det_obj = conv_list( it_list ).
    LOOP AT it_det_obj ASSIGNING &lt;obj&gt;.
      CLEAR it_obj.
      APPEND &lt;obj&gt; TO it_obj.
      CALL FUNCTION &apos;RS_MASS_ACTIVATION&apos;
        EXPORTING
          p_wb_manager = _wb_manager
        TABLES
          OBJECTS      = it_obj.
    ENDLOOP.
  ENDIF.
  check_inactive_objects( CHANGING obj_list = it_list ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ACTIVATE_OBJECTS" EXPOSURE="1" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Activate Objects (not DDIC)"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="ITEMS" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_ITEMS">
      <TEXTS>
       <ITEM LANG="E" TEXT="Detailled list of object in Working area"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="PROGRAMS" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_MAINPROGS">
      <TEXTS>
       <ITEM LANG="E" TEXT="List of main programs"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  FIELD-SYMBOLS:
    &lt;it&gt; LIKE LINE OF it_items,
    &lt;mp&gt; LIKE LINE OF programs.

* Code from LSEWORKINGAREAFGE (form generate_active_object)
  DATA: l_w_area TYPE tt_items,
        l_w_items TYPE tt_items,
        l_master TYPE rsnewleng-programm,
        BEGIN OF l_dynp_id,
          prog TYPE progname,
          dnum TYPE dynpronr,
        END OF l_dynp_id,
        message(240) TYPE c,
        l_page TYPE seu_objkey,
        l_imp_name TYPE exit_imp,
        l_navigate TYPE sy-calld,
        l_subrc TYPE sy-subrc,
        l_clskey TYPE seoclskey,
        l_wapd_class TYPE seoclskey-clsname
                   VALUE &apos;CL_O2_API_APPLICATION&apos;,
        l_sfpf_class TYPE seoclskey-clsname
                   VALUE &apos;CL_FP_WB_HELPER&apos;,
        l_appl TYPE o2applname,
        l_obj_name TYPE e071-obj_name,
        l_exception TYPE REF TO cx_root,
        l_message_text TYPE string.

  LOOP AT programs ASSIGNING &lt;mp&gt;.
    IF &lt;mp&gt;-master &lt;&gt; l_master.
      l_master = &lt;mp&gt;-master.
      CHECK &lt;mp&gt;-error IS INITIAL.
      CHECK &lt;mp&gt;-include(1) &lt;&gt; &apos;&lt;&apos; AND
            &lt;mp&gt;-include(1) &lt;&gt; &apos;&gt;&apos;.
      CASE &lt;mp&gt;-object.
        WHEN &apos;REPS&apos;.
*          data: l_with_dialog type c.
*          if g_no_dialog is initial.
*            l_with_dialog = &apos;X&apos;.
*          endif.
          CALL FUNCTION &apos;REPS_OBJECT_GENERATE&apos;
            EXPORTING
              i_program        = l_master
*              i_with_dialog    = l_with_dialog
            IMPORTING
              o_gen_message    = message
              o_gen_subrc      = l_subrc
              o_navigate       = l_navigate
*              o_cancel         = g_cancel_flag
            EXCEPTIONS
              syntax_error     = 1
              generation_error = 2
              OTHERS           = 3.
          IF l_subrc &lt;&gt; 0 OR sy-subrc &lt;&gt; 0.
*            PERFORM dequeue_objects.
*            IF l_subrc &gt;= 8.
** Hier hat ein Roll-Back stattgefunden und hoffentlich nur hier!!!***JR
*              CALL FUNCTION &apos;RS_WORKING_AREA_INIT&apos;
*                EXPORTING
*                  force_initialisation = &apos;X&apos;.
*            ENDIF.
*            IF NOT l_navigate IS INITIAL.
*              PERFORM navigate_to_object.
*            ENDIF.
*            IF l_subrc &gt;= 8.
*              MESSAGE e826(eu) RAISING execution_error.
*            ENDIF.
          ENDIF.
        WHEN &apos;CREP&apos; OR &apos;CPUB&apos; OR &apos;CPRI&apos; OR &apos;CPRO&apos; OR &apos;METH&apos;
             OR &apos;CINC&apos; OR &apos;CLAS&apos;.
          l_clskey = l_master.
          CALL FUNCTION &apos;SEO_CLASS_GENERATE_LOAD&apos;
            EXPORTING
              clskey             = l_clskey
            EXCEPTIONS
              syntax_error       = 1
              generation_failure = 2
              OTHERS             = 3.
          IF sy-subrc &lt;&gt; 0.
*            IF NOT sy-msgid IS INITIAL.
*              g_cancel_flag = &apos;3&apos;.
*              MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
*                      WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
*            ENDIF.
          ENDIF.
        WHEN &apos;INTF&apos;.
          l_clskey = l_master.
          CALL FUNCTION &apos;SEO_INTERFACE_GENERATE_LOAD&apos;
            EXPORTING
              intkey             = l_clskey
            EXCEPTIONS
              syntax_error       = 1
              generation_failure = 2
              OTHERS             = 3.
          IF sy-subrc &lt;&gt; 0.
*            IF NOT sy-msgid IS INITIAL.
*              g_cancel_flag = &apos;3&apos;.
*              MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
*                      WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
*            ENDIF.
          ENDIF.
        WHEN &apos;WAPD&apos; OR &apos;WAPA&apos;.
** O2-HTML-Seiten
          l_appl = &lt;it&gt;-obj_name.
          CALL METHOD (l_wapd_class)=&gt;generate_application
            EXPORTING
              p_application = l_appl
            EXCEPTIONS
              OTHERS        = 1.
          IF sy-subrc &lt;&gt; 0.
*            IF NOT sy-msgid IS INITIAL.
*              g_cancel_flag = &apos;3&apos;.
*              MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
*                      WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
*            ENDIF.
          ENDIF.
        WHEN &apos;WDYN&apos; OR &apos;WDYD&apos; OR &apos;WDYV&apos; OR &apos;WDYC&apos;.
          l_obj_name = l_master.
          CALL FUNCTION &apos;WDY_WB_GENERATE&apos;
            EXPORTING
              p_object_name        = l_obj_name
              p_suppress_index_upd = &apos; &apos;
            EXCEPTIONS
              not_existing         = 1
              error_occured        = 2
              syntax_error         = 3
              OTHERS               = 4.
          IF sy-subrc &lt;&gt; 0.
*            PERFORM dequeue_objects.
*            IF NOT sy-msgid IS INITIAL.
*              g_cancel_flag = &apos;3&apos;.
*              MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
*                      WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
*            ENDIF.
          ENDIF.

** Enhancement Objects:
        WHEN &apos;ENHO&apos; OR &apos;ENHC&apos; OR &apos;ENHS&apos; OR&apos;ENSC&apos;.
          l_obj_name = l_master.
          CALL FUNCTION &apos;ENH_WB_GENERATE&apos;
            EXPORTING
              p_object_name        = l_obj_name
              p_obj_type           = &lt;mp&gt;-object
              p_suppress_index_upd = &apos; &apos;
            EXCEPTIONS
              not_existing         = 1
              error_occured        = 2
              syntax_error         = 3
              OTHERS               = 4.
          IF sy-subrc &lt;&gt; 0.
*            PERFORM dequeue_objects.
*            IF NOT sy-msgid IS INITIAL.
*              g_cancel_flag = &apos;3&apos;.
*              MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
*                      WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
*            ENDIF.
          ENDIF.


** Switch Framework:
        WHEN &apos;SFBF&apos; OR &apos;SFSW&apos; OR &apos;SFBS&apos; OR &apos;SF01&apos;.
          l_obj_name = l_master.
          CALL FUNCTION &apos;SFW_WB_GENERATE&apos;
            EXPORTING
              p_object_name        = l_obj_name
              p_obj_type           = &lt;mp&gt;-object
              p_suppress_index_upd = &apos; &apos;
            EXCEPTIONS
              not_existing         = 1
              error_occured        = 2
              syntax_error         = 3
              OTHERS               = 4.
          IF sy-subrc &lt;&gt; 0.
*            PERFORM dequeue_objects.
*            IF NOT sy-msgid IS INITIAL.
*              MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
*                      WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
*            ENDIF.
          ENDIF.



        WHEN &apos;SFPI&apos;.
** Formularinterface
          l_obj_name = &lt;it&gt;-obj_name.
          TRY.
              CALL METHOD (l_sfpf_class)=&gt;interface_generate
                EXPORTING
                  i_name = l_obj_name.
            CATCH cx_fp_api_usage
                  cx_fp_api_repository
                  cx_fp_api_internal INTO l_exception.
              CLEAR l_message_text.
              l_message_text = l_exception-&gt;get_text( ).
*              IF NOT l_message_text IS INITIAL.
*                g_cancel_flag = &apos;3&apos;.
*                MESSAGE l_message_text TYPE &apos;E&apos;.
*              ENDIF.
          ENDTRY.
        WHEN &apos;SFPF&apos;.
** Formulare
          l_obj_name = &lt;it&gt;-obj_name.
          TRY.
              CALL METHOD (l_sfpf_class)=&gt;form_generate
                EXPORTING
                  i_name = l_obj_name.
            CATCH cx_fp_api_usage
                  cx_fp_api_repository
                  cx_fp_api_internal INTO l_exception.
              CLEAR l_message_text.
              l_message_text = l_exception-&gt;get_text( ).
*              IF NOT l_message_text IS INITIAL.
*                g_cancel_flag = &apos;3&apos;.
*                MESSAGE l_message_text TYPE &apos;E&apos;.
*              ENDIF.
          ENDTRY.
      ENDCASE.
    ENDIF.
  ENDLOOP.
  LOOP AT items ASSIGNING &lt;it&gt;.
    CASE &lt;it&gt;-object.
      WHEN &apos;DYNP&apos;.
        l_dynp_id = &lt;it&gt;-obj_name.
        CALL FUNCTION &apos;RS_SCRP_SERVICE&apos;
             EXPORTING
                  dynnr           = l_dynp_id-dnum
                  function        = swbm_c_op_activate
                  progname        = l_dynp_id-prog
                  suppress_checks = &apos; &apos;
*               p_wb_checklist  = l_checklist
             IMPORTING
                  error_subrc     = l_subrc
             EXCEPTIONS
                  illegal_value   = 1
                  not_exists      = 2
                  cancelled       = 3
                  OTHERS          = 4.
        IF sy-subrc &lt;&gt; 0 OR l_subrc &lt;&gt; 0 .
*          g_cancel_flag = &apos;X&apos;.
*          IF NOT sy-msgid IS INITIAL.
*            MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
*                    WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4
*                    RAISING execution_error.
*          ENDIF.
        ENDIF.
      WHEN &apos;CUAD&apos;.
        l_obj_name = &lt;it&gt;-obj_name.
        CALL FUNCTION &apos;CUAD_OBJECT_GENERATE&apos;
          EXPORTING
            object_name       = l_obj_name
          EXCEPTIONS
            generation_failed = 1
            OTHERS            = 2.
        IF sy-subrc &lt;&gt; 0.
*          MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
*                  WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4
*                  RAISING execution_error.
        ENDIF.
      WHEN &apos;WAPP&apos;.
        l_page = &lt;it&gt;-obj_name.
        CALL FUNCTION &apos;O2_GENERATE_PAGE&apos;
          EXPORTING
            p_composite_name = l_page
          EXCEPTIONS
            not_found        = 1
            error_occured    = 2
            OTHERS           = 3.
        IF sy-subrc &lt;&gt; 0.
*          g_cancel_flag = &apos;3&apos;.
*          MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
*                  WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
        ENDIF.
      WHEN &apos;SXCI&apos;.
        l_imp_name =  &lt;it&gt;-obj_name.
        CALL FUNCTION &apos;SXO_IMPL_ACTIVE&apos;
          EXPORTING
            imp_name                  = l_imp_name
          EXCEPTIONS
            badi_not_existing         = 1
            imp_not_existing          = 2
            already_active            = 3
            data_inconsistency        = 4
            activation_not_admissable = 5
            action_canceled           = 6
            access_failure            = 7
            OTHERS                    = 8.
        IF sy-subrc &lt;&gt; 0.
*          g_cancel_flag = &apos;3&apos;.
*          MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
*                  WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
        ENDIF.
    ENDCASE.
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_FROM_TADIR" EXPOSURE="2" STATE="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Analyse components"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="AUTHOR" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TR_AUTHOR">
      <TEXTS>
       <ITEM LANG="E" TEXT="Author"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="EXT" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL">
      <TEXTS>
       <ITEM LANG="E" TEXT="Extend to sub packages"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NAME" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TR_COMPNAME">
      <TEXTS>
       <ITEM LANG="E" TEXT="Component Name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="PACKAGES" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TR_PACKAGES">
      <TEXTS>
       <ITEM LANG="E" TEXT="Package"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="SRCSYSTEM" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TR_SRCSYSTEM">
      <TEXTS>
       <ITEM LANG="E" TEXT="Package"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="TYPE" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TR_COMPTYPE">
      <TEXTS>
       <ITEM LANG="E" TEXT="Component Type"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA t_keys      TYPE tt_compkeys.

  t_keys = zaplink_tools=&gt;get_keys_from_tadir( srcsystem = srcsystem
                                                   type  = type
                                                    name = name
                                                packages = packages
                                                     ext = ext
                                                  author = author ).
  CHECK NOT t_keys IS INITIAL.
  add_keys( t_keys ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_KEYS" EXPOSURE="2" STATE="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Add keys to worklist"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="OBJ_LIST" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_COMPKEYS">
      <TEXTS>
       <ITEM LANG="E" TEXT="Object list"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA t_obj_list TYPE tt_objlist.
  DATA local_list TYPE tt_compkeys.
  DATA flag       TYPE abap_bool.
  FIELD-SYMBOLS &lt;wa&gt; LIKE LINE OF local_list.

* Issue 137 : Remove unvalid (that is not supposed to be activated) object types
  local_list = obj_list.
  SORT local_list.
  LOOP AT local_list ASSIGNING &lt;wa&gt;.
    AT NEW type.
      CALL FUNCTION &apos;RS_OBJ_SUPPORTS_INACTIVE&apos;
        EXPORTING
          obj_type          = space
          sub_type          = &lt;wa&gt;-type
        IMPORTING
          supports_inactive = flag.
      IF flag IS INITIAL.   &quot; If Not activable =&gt; Remove
        DELETE local_list WHERE type = &lt;wa&gt;-type.
      ENDIF.
    ENDAT.
  ENDLOOP.

  APPEND LINES OF local_list TO component_list.
  SORT component_list BY type name.   DELETE ADJACENT DUPLICATES FROM component_list COMPARING type name.
  t_obj_list = compkeys_2_objlist( obj_list ).
  APPEND LINES OF t_obj_list TO it_obj_list.
  SORT it_obj_list BY object obj_name.    DELETE ADJACENT DUPLICATES FROM it_obj_list COMPARING object obj_name.
  object_count = lines( it_obj_list ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_LIST" EXPOSURE="2" STATE="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Add list to worklist"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="O_LIST" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_LIST">
      <TEXTS>
       <ITEM LANG="E" TEXT="ZapLink Components list"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA t_comps      TYPE tt_compkeys.
  CHECK o_list IS BOUND.
  t_comps = o_list-&gt;get_keys( ).
  add_keys( t_comps ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_OBJ_TO_WA" EXPOSURE="1" STATE="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Add objects to Work area"/>
    </TEXTS>
    <SOURCE>`
  FIELD-SYMBOLS &lt;wa&gt;   LIKE LINE OF it_obj_list.
  DATA name TYPE td_compname.
  LOOP AT it_obj_list ASSIGNING &lt;wa&gt;.
    name = &lt;wa&gt;-obj_name.
* Issue 137 =&gt; Use commun way to add into Working Area
*    IF zaplink_tools=&gt;is_working_areable( &lt;wa&gt;-object ) = abap_true.
*      CALL FUNCTION &apos;RS_INSERT_INTO_WORKING_AREA&apos;
*        EXPORTING
*          object                  = &lt;wa&gt;-object
*          obj_name                = &lt;wa&gt;-obj_name
**       DELETED_FLAG            = &apos; &apos;
**     IMPORTING
**       OBJECT_INSERTED         =
*        EXCEPTIONS
*          wrong_object_name       = 1
*          OTHERS                  = 2
*                .
*      IF sy-subrc &lt;&gt; 0.
** MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
**         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
*      ENDIF.
*    ENDIF.
    zaplink_tools=&gt;add_comp_to_working_area( type = &lt;wa&gt;-object
                                             name = name ).
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ASK_FOR_ACTIVATION" EXPOSURE="2" STATE="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Ask to user before Activate"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="RESULT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TT_COMPKEYS">
      <TEXTS>
       <ITEM LANG="E" TEXT="Objects list not activate"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZCX_ZAPLINK" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="ZAPlink Framework : Root exception class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA d_count    TYPE i.
  DATA d_answer   TYPE c.
  DATA d_msg      TYPE string.
  DATA o_cx       TYPE REF TO zcx_zaplink.

  CLEAR activation_requested.
  d_count = LINES( it_obj_list ).   d_msg = d_count.  CONDENSE d_msg.
  CONCATENATE &apos;Would you like to activate the objects (&apos;(t01) d_msg &apos;) that have been installed ?&apos;(t02) INTO d_msg. &quot;#EC NOTEXT
  CALL FUNCTION &apos;POPUP_TO_CONFIRM&apos;
    EXPORTING
      titlebar              = &apos;Activate imported objects&apos;(ptb)
      text_question         = d_msg
      text_button_1         = &apos;Yes&apos;(yes)
      icon_button_1         = &apos;ICON_ACTIVATE&apos;               &quot;#EC NOTEXT
      text_button_2         = &apos;No&apos;(no_)
      icon_button_2         = &apos;ICON_SKIP&apos;                   &quot;#EC NOTEXT
      default_button        = &apos;1&apos;                           &quot;#EC NOTEXT
      display_cancel_button = abap_false
      iv_quickinfo_button_1 = &apos;All object will be activate as far as possible&apos;(qi1) &quot;#EC NOTEXT
      iv_quickinfo_button_2 = &apos;No object activation at all&apos;(qi2) &quot;#EC NOTEXT
    IMPORTING
      answer                = d_answer
    EXCEPTIONS
      text_not_found        = 1
      OTHERS                = 2.
  IF sy-subrc &lt;&gt; 0.
    o_cx = zcx_zaplink=&gt;create_from_mf_cx( funcname = &apos;POPUP_TO_CONFIRM&apos;
                                              subrc = sy-subrc ) .
    RAISE EXCEPTION o_cx.
  ENDIF.
  IF d_answer CO &apos;YJ1&apos;.
    activation_requested = abap_true.
    result = activate( ).
  ELSE.
    result = objlist_2_compkeys( it_obj_list ).
  ENDIF.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CHECK_INACTIVE_OBJECTS" EXPOSURE="2" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Get inactive objects"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="OBJ_LIST" CMPTYPE="1" PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_OBJLIST">
      <TEXTS>
       <ITEM LANG="E" TEXT="Objects list"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA my_obj LIKE obj_list.
  DATA inact TYPE tt_items.
  FIELD-SYMBOLS &lt;obj&gt; LIKE LINE OF obj_list.

  LOOP AT obj_list ASSIGNING &lt;obj&gt;.
    REFRESH: my_obj, inact.   APPEND &lt;obj&gt; TO my_obj.
* Get all inactive Objects of List
    CALL FUNCTION &apos;RS_INACTIVE_OBJECTS_WARNING&apos;
      EXPORTING
        suppress_protocol               = &apos;X&apos;
*     WITH_PROGRAM_INCLUDES           = &apos; &apos;
*     SUPPRESS_DICTIONARY_CHECK       = &apos; &apos;
      TABLES
        p_e071                          = my_obj
*     P_XMSG                          =
        p_dwinactiv                     = inact.
*     USERNAME                        =
    IF inact IS INITIAL.    DELETE obj_list.    ENDIF.
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="COMPKEYS_2_GENSET" EXPOSURE="1" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Convert List from Compkeys to Generation Set"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="KEYS" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_COMPKEYS">
      <TEXTS>
       <ITEM LANG="E" TEXT="Component List"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TT_GENSET">
      <TEXTS>
       <ITEM LANG="E" TEXT="Generation SET"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA          s_obj LIKE LINE OF result.
  FIELD-SYMBOLS &lt;k&gt;   LIKE LINE OF keys.

  LOOP AT keys ASSIGNING &lt;k&gt;.
    CLEAR s_obj.
    s_obj-object = &lt;k&gt;-type.
    s_obj-objname = &lt;k&gt;-name.
    s_obj-pgmid = zaplink_connectors=&gt;get_typekind( &lt;k&gt;-type ).
*    s_obj-component
    APPEND s_obj TO result.
  ENDLOOP.
  SORT result BY object objname.
* determine the program names on the basis of the TADIR keys *
* Form is not suppose to get only :
*    CASE lv_tadirobject.
**----------------------------programs--------------------------------
*      WHEN &apos;PROG&apos;.
**----------------------------function groups ------------------------
*      WHEN &apos;FUGR&apos;.
**-----------------function groups with customer include ----------------
** if FUGX exists then also FUGS exists
** Since the prognames of FUGX and FUGS are identical, FUGX needn&apos;t be
** considered here.
*      WHEN &apos;FUGS&apos;.
**---------------------------logical database, 2 programs---------------
*      WHEN &apos;LDBA&apos;.
**-----------------------classes and interfaces--------------------------
*      WHEN &apos;CLAS&apos; OR &apos;INTF&apos;.
**------------------------------type-pool--------------------------------
*      WHEN &apos;TYPE&apos;.
*    ENDCASE.
* It generate wrong program name.
  PERFORM tadir_2_trdir IN PROGRAM rsparagenlod
          CHANGING result.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="COMPKEYS_2_OBJLIST" EXPOSURE="1" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Convert List from Compkeys to Objlist"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="KEYS" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_COMPKEYS">
      <TEXTS>
       <ITEM LANG="E" TEXT="Component List"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TT_OBJLIST">
      <TEXTS>
       <ITEM LANG="E" TEXT="Objects list"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA          s_obj LIKE LINE OF result.
  FIELD-SYMBOLS &lt;k&gt;   LIKE LINE OF keys.
  LOOP AT keys ASSIGNING &lt;k&gt;.   CLEAR s_obj.  s_obj-object = &lt;k&gt;-type.    s_obj-obj_name = &lt;k&gt;-name.  APPEND s_obj TO result.   ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CONV_LIST" EXPOSURE="1" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Convert List format"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="ITEM_LIST" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TT_ITEMS">
      <TEXTS>
       <ITEM LANG="E" TEXT="Detailled list of object in Working area"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="OBJ_LIST" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_OBJLIST">
      <TEXTS>
       <ITEM LANG="E" TEXT="Objects list"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA _item LIKE LINE OF item_list.
  FIELD-SYMBOLS &lt;obj&gt;   LIKE LINE OF obj_list.
  LOOP AT obj_list ASSIGNING &lt;obj&gt;.   MOVE-CORRESPONDING &lt;obj&gt; TO _item.    APPEND _item TO item_list.    ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GENERATE" EXPOSURE="2" STATE="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Generate components"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="RESULT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TT_COMPKEYS">
      <TEXTS>
       <ITEM LANG="E" TEXT="Objects list not activate"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  CONSTANTS gc_gen_types(8) TYPE c VALUE &apos;1CFJKMST&apos;.
  DATA t_genset   TYPE tt_genset.
  DATA t_trdir    TYPE HASHED TABLE OF trdir WITH UNIQUE KEY name.
  FIELD-SYMBOLS:
    &lt;dir&gt; LIKE LINE OF t_trdir,
    &lt;obj&gt; LIKE LINE OF t_genset.

  t_genset = compkeys_2_genset( component_list ).

* Clean list
  SORT t_genset BY name.
  DELETE ADJACENT DUPLICATES FROM t_genset COMPARING name.
* Remove component type that can&apos;t be generated
* FROM RSPARAGENLOD(3496) FORM get_component_objects
  DELETE t_genset WHERE name IS INITIAL
                    OR NOT ( object = &apos;PROG&apos; OR
                             object = &apos;FUGR&apos; OR
                             object = &apos;FUGS&apos; OR
                             object = &apos;CLAS&apos; OR
                             object = &apos;INTF&apos; OR
                             object = &apos;TYPE&apos; OR
                             object = &apos;LDBA&apos; )
                   OR NOT pgmid = &apos;R3TR&apos;.

* Remove programs that can&apos;t be generated : Include, ....
*      PERFORM trdir_check IN PROGRAM rsparagenlod
  SELECT * INTO TABLE t_trdir
    FROM trdir
    FOR ALL ENTRIES IN t_genset
    WHERE name = t_genset-name
    %_HINTS ORACLE &apos;&amp;max_blocking_factor 250&amp;&apos;.

  LOOP AT t_genset ASSIGNING &lt;obj&gt;.
    READ TABLE t_trdir ASSIGNING &lt;dir&gt;
         WITH TABLE KEY name = &lt;obj&gt;-name.
    CHECK sy-subrc = 0.
    If not &lt;dir&gt;-subc CA gc_gen_types.    Clear &lt;obj&gt;-name.     endif.
  ENDLOOP.
  DELETE t_genset WHERE name IS INITIAL.

  CALL FUNCTION &apos;SUBST_GENER8_ABAP_LOADS&apos;
    EXPORTING
      countmax   = 100    &quot; commit every 100 obejcts
    TABLES
      it_gensetc = t_genset.

* Generation Status (X = generated, E/S = error, I = initial)
  DELETE t_genset WHERE NOT genstatus = &apos;E&apos; AND NOT genstatus = &apos;S&apos;.

  result = genset_2_compkeys( t_genset ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GENSET_2_COMPKEYS" EXPOSURE="1" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Convert List from Generation Set to Compkeys"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="KEYS" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_GENSET">
      <TEXTS>
       <ITEM LANG="E" TEXT="Generation Set"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TT_COMPKEYS">
      <TEXTS>
       <ITEM LANG="E" TEXT="Component List"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA          s_obj LIKE LINE OF result.
  FIELD-SYMBOLS &lt;k&gt;   LIKE LINE OF keys.
  LOOP AT keys ASSIGNING &lt;k&gt;.   CLEAR s_obj.  s_obj-type = &lt;k&gt;-object.    s_obj-name = &lt;k&gt;-objname.    APPEND s_obj TO result.   ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_INACTIVE_OBJECTS" EXPOSURE="2" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Get inactive objects"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="INACT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TT_DET_OBJ"/>
     <ITEM SCONAME="OBJ_LIST" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_OBJLIST">
      <TEXTS>
       <ITEM LANG="E" TEXT="Objects list"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
* Get all inactive Objects of List
  CALL FUNCTION &apos;RS_INACTIVE_OBJECTS_WARNING&apos;
    EXPORTING
      SUPPRESS_PROTOCOL               = &apos;X&apos;
*     WITH_PROGRAM_INCLUDES           = &apos; &apos;
*     SUPPRESS_DICTIONARY_CHECK       = &apos; &apos;
    TABLES
      P_E071                          = OBJ_LIST
*     P_XMSG                          =
      P_DWINACTIV                     = INACT.
*     USERNAME                        =</SOURCE>
   </ITEM>
   <ITEM CMPNAME="OBJLIST_2_COMPKEYS" EXPOSURE="1" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Convert List from Objlist to Compkeys"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="KEYS" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_OBJLIST">
      <TEXTS>
       <ITEM LANG="E" TEXT="Objects list"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TT_COMPKEYS">
      <TEXTS>
       <ITEM LANG="E" TEXT="Component List"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA          s_obj LIKE LINE OF result.
  FIELD-SYMBOLS &lt;k&gt;   LIKE LINE OF keys.
  LOOP AT keys ASSIGNING &lt;k&gt;.   CLEAR s_obj.  s_obj-type = &lt;k&gt;-object.    s_obj-name = &lt;k&gt;-obj_name.    APPEND s_obj TO result.   ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="RESET" EXPOSURE="2" STATE="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Reset worklist"/>
    </TEXTS>
    <SOURCE>`
  CLEAR: it_items, it_obj_list, component_list, activation_requested, object_count, force_activation.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="SPLIT_LIST" EXPOSURE="1" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Split list into DDIC and objects"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="DDIC" CMPTYPE="1" PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_OBJLIST">
      <TEXTS>
       <ITEM LANG="E" TEXT="Objects list"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="OBJ_LIST" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_OBJLIST">
      <TEXTS>
       <ITEM LANG="E" TEXT="Objects list"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="PROG_LIST" CMPTYPE="1" PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_OBJLIST">
      <TEXTS>
       <ITEM LANG="E" TEXT="Objects list"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  FIELD-SYMBOLS &lt;obj&gt;   LIKE LINE OF obj_list.
  LOOP AT obj_list ASSIGNING &lt;obj&gt;.

    IF &lt;obj&gt;-object = &apos;DTEL&apos; OR
       &lt;obj&gt;-object = &apos;VIEW&apos; OR
       &lt;obj&gt;-object = &apos;DOMA&apos; OR
       &lt;obj&gt;-object = &apos;TTYP&apos; OR
       &lt;obj&gt;-object = &apos;INDX&apos; OR
       &lt;obj&gt;-object = &apos;XINX&apos; OR
       &lt;obj&gt;-object = &apos;SHLP&apos; OR
       &lt;obj&gt;-object = &apos;ENQU&apos; OR
       &lt;obj&gt;-object = &apos;MCOB&apos; OR
       &lt;obj&gt;-object = &apos;TABL&apos; OR
       &lt;obj&gt;-object = &apos;SQLT&apos; OR
       &lt;obj&gt;-object = &apos;STRU&apos;.
      APPEND &lt;obj&gt; TO ddic.
    ELSE.
      APPEND &lt;obj&gt; TO prog_list.
    ENDIF.
  ENDLOOP.</SOURCE>
   </ITEM>
  </METHODS>
  <TEXTSPOOL>
   <ITEM ID="I" KEY="T01">
    <TEXTS>
     <ITEM LANGU="E" ENTRY="Would you like to activate the objects (" LENGTH="50 "/>
    </TEXTS>
   </ITEM>
   <ITEM ID="I" KEY="T02">
    <TEXTS>
     <ITEM LANGU="E" ENTRY=") that have been installed ?" LENGTH="40 "/>
    </TEXTS>
   </ITEM>
  </TEXTSPOOL>
  <TYPEGROUPS>
   <ITEM TYPEGROUP="ABAP" EXPLICIT="X"/>
   <ITEM TYPEGROUP="SEWOR" EXPLICIT="X"/>
   <ITEM TYPEGROUP="SWBM" EXPLICIT="X"/>
  </TYPEGROUPS>
  <TYPES>
   <ITEM CMPNAME="TO_LIST" EXPOSURE="2" STATE="1" TYPTYPE="3" TYPE="ZAPLINK_LIST">
    <TEXTS>
     <ITEM LANG="E" TEXT="ZapLink Components list"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TT_DET_OBJ" EXPOSURE="2" STATE="1" EDITORDER="3 " TYPTYPE="4">tt_det_obj TYPE STANDARD TABLE OF dwinactiv WITH NON-UNIQUE DEFAULT KEY
`</ITEM>
   <ITEM CMPNAME="TT_GENSET" EXPOSURE="2" STATE="1" EDITORDER="2 " TYPTYPE="4">
    tt_GENSET  type STANDARD TABLE OF GENSETC with NON-UNIQUE DEFAULT KEY
`
    <TEXTS>
     <ITEM LANG="E" TEXT="Generation Set of component"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TT_ITEMS" EXPOSURE="1" STATE="1" EDITORDER="3 " TYPTYPE="4">
    tt_items TYPE STANDARD TABLE OF sewor_working_area WITH NON-UNIQUE DEFAULT KEY
    <TEXTS>
     <ITEM LANG="E" TEXT="Detailled list of object in Working area"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TT_MAINPROGS" EXPOSURE="1" STATE="1" EDITORDER="2 " TYPTYPE="4">
    tt_mainprogs TYPE STANDARD TABLE OF t_mainprog WITH NON-UNIQUE DEFAULT KEY
    <TEXTS>
     <ITEM LANG="E" TEXT="List of main programs"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TT_OBJLIST" EXPOSURE="2" STATE="1" EDITORDER="1 " TYPTYPE="4">
    TT_OBJLIST type STANDARD TABLE OF E071 with NON-UNIQUE DEFAULT KEY
`
    <TEXTS>
     <ITEM LANG="E" TEXT="Objects list"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="T_MAINPROG" EXPOSURE="1" STATE="1" EDITORDER="1 " TYPTYPE="4">
    BEGIN OF t_mainprog,
      master TYPE d010inc-master,
      include TYPE d010inc-include,
      object TYPE e071-object,
      error(1) TYPE c,
      switch_state(1) TYPE c,
    END OF t_mainprog
    <TEXTS>
     <ITEM LANG="E" TEXT="Line of mainprogram"/>
    </TEXTS>
   </ITEM>
  </TYPES>
 </RAW>
</ZL_OBJECT>
